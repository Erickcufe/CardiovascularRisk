if(age >= 60 & age <= 64){age <- 5}
if(age >= 55 & age <= 59){age <- 4}
if(age >= 50 & age <= 54){age <- 3}
if(age >= 45 & age <= 49){age <- 2}
if(age >= 40 & age <= 44){age <- 1}
return(age)
}
sbp_levels <- function(sbp){
if(sbp >= 180){sbp <- 5}
if(sbp >= 160 & sbp <= 179){sbp <- 4}
if(sbp >= 140 & sbp <= 159){sbp <- 3}
if(sbp >= 120 & sbp <= 139){sbp <- 2}
if(sbp < 120){sbp <- 1}
return(sbp)
}
cho_levels <- function(cho) {
if(cho < 4){
cho <- 1
}
if(cho >= 4 & cho <= 4.9){
cho <- 2
}
if(cho >= 5 & cho <= 5.9){
cho <- 3
}
if(cho >= 6 & cho <= 6.9){
cho <- 4
}
if(cho >= 7){
cho <- 5
}
return(cho)
}
sapply(age, age_levels)
sapply(sbp, sbp_levels)
sbp_levels <- function(sbp){
if(sbp >= 180){sbp <- 5}
if(sbp >= 160 & sbp <= 179){sbp <- 4}
if(sbp >= 140 & sbp <= 159){sbp <- 3}
if(sbp >= 120 & sbp <= 139){sbp <- 2}
if(sbp < 120){sbp <- 1}
print(sbp)
return(sbp)
}
sapply(sbp, sbp_levels)
sapply(cholesterol, cho_levels)
x <- sbp[2]
if(x >= 180){x <- 5}
if(x >= 160 & x <= 179){x <- 4}
if(x >= 140 & x <= 159){x <- 3}
if(x >= 120 & x <= 139){x <- 2}
if(x < 120){x <- 1}
print(x)
x < 120
x <- sbp[2]
if(x < 120){x <- 1}
if(x >= 180){x <- 5}
if(x >= 160 & x <= 179){x <- 4}
if(x >= 140 & x <= 159){x <- 3}
if(x >= 120 & x <= 139){x <- 2}
print(x)
age_levels <- function(x){
if(x < 40){x <- 8}
if(x > 75){x <- 8}
if(x >= 70 & x <= 74){x <- 7}
if(x >= 65 & x <= 69){x <- 6}
if(x >= 60 & x <= 64){x <- 5}
if(x >= 55 & x <= 59){x <- 4}
if(x >= 50 & x <= 54){x <- 3}
if(x >= 45 & x <= 49){x <- 2}
if(x >= 40 & x <= 44){x <- 1}
return(x)
}
sbp_levels <- function(x){
if(x < 120){x <- 1}
if(x >= 180){x <- 5}
if(x >= 160 & x <= 179){x <- 4}
if(x >= 140 & x <= 159){x <- 3}
if(x >= 120 & x <= 139){x <- 2}
return(x)
}
cho_levels <- function(cho) {
if(cho < 4){cho <- 1}
if(cho >= 4 & cho <= 4.9){cho <- 2}
if(cho >= 5 & cho <= 5.9){cho <- 3}
if(cho >= 6 & cho <= 6.9){cho <- 4}
if(cho >= 7){cho <- 5}
return(cho)
}
sapply(age, age_levels)
sapply(sbp, sbp_levels)
age <- sapply(age, age_levels)
sbp <- sapply(sbp, sbp_levels)
cholesterol <- sapply(cholesterol, cho_levels)
df <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age,
SBP = sbp, Total_Cholesterol = cholesterol)
df$score <- CardiovascularRisk::ref1[ref1$Diabetes == df$Diabetes &
ref1$Gender == df$Gender &
ref1$Smoke == df$Smoke &
ref1$Age == df$Age &
ref1$SBP == df$SBP &
ref1$Cholesterol == df$Total_Cholesterol, "Score"]
devtools::load_all(".")
df$score <- CardiovascularRisk::ref1[ref1$Diabetes == df$Diabetes &
ref1$Gender == df$Gender &
ref1$Smoke == df$Smoke &
ref1$Age == df$Age &
ref1$SBP == df$SBP &
ref1$Cholesterol == df$Total_Cholesterol, "Score"]
which(age == 8)
which(df$Age == 8)
which(df$Age == 10)
length(which(df$Age == 10))
paste("The patient number: ", which(df$Age == 8), "has the age out of range to calculate the risk score")
df <- df[df$Age!= 8, ]
df$score <- CardiovascularRisk::ref1[ref1$Diabetes == df$Diabetes &
ref1$Gender == df$Gender &
ref1$Smoke == df$Smoke &
ref1$Age == df$Age &
ref1$SBP == df$SBP &
ref1$Cholesterol == df$Total_Cholesterol, "Score"]
df$score <- CardiovascularRisk::ref1[ref1$Diabetes == df$Diabetes & ref1$Gender == df$Gender &ref1$Smoke == df$Smoke &ref1$Age == df$Age &ref1$SBP == df$SBP &ref1$Cholesterol == df$Total_Cholesterol, "Score"]
ref1$Diabetes == df$Diabetes
vect <- df[i,]
i <- 3
vect <- df[i,]
View(vect)
View(vect)
vect <- vector(df[i,])
select <- CardiovascularRisk::ref1[2,
]
View(select)
dat <- CardiovascularRisk::ref1
View(dat)
select <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
select
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
df$Score <- select
View(df)
ver1 <- append(select, "NR", after = thebad-1)
thebad <- which(df$Age == 8)
ver1 <- append(select, "NR", after = thebad-1)
df <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age_1,
SBP = sbp_1, Total_Cholesterol = cholesterol_1)
age_1 <- sapply(age, age_levels)
sbp_1 <- sapply(sbp, sbp_levels)
cholesterol_1 <- sapply(cholesterol, cho_levels)
Age <- c(40, 87, 65, 53, 71) #Age in years
Gender <- c(0,0,0,1,1) #0=female, 1=male
Smoking <- c(1,1,0,1,0) #0=non-smoker 1=smoker
Systolic_Blood_Pressure <- c(129, 157, 134, 189, 141) #SBP in mmHg
Diabetes <- c(1,1,1,0,1) #0=not diabetic 1=diabetic
cholesterol <- c(0, 5.1, 4.5, 0, 8.3) #Total cholesterol (mmol/L, 0=unknown cholesterol)
diabetes = Diabetes
gender = Gender
smoke = Smoking
age = Age
sbp = Systolic_Blood_Pressure
cholesterol = cholesterol
age_1 <- sapply(age, age_levels)
sbp_1 <- sapply(sbp, sbp_levels)
cholesterol_1 <- sapply(cholesterol, cho_levels)
df_dummy <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age,
SBP = sbp, Total_Cholesterol = cholesterol)
df <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age_1,
SBP = sbp_1, Total_Cholesterol = cholesterol_1)
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score")
df_1 <- df[df$Age!= 8, ]
}
View(df_1)
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
message(paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score"))
df <- df[df$Age!= 8, ]
}
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
ver1 <- append(select, "NR", after = thebad-1)
thebad <- which(df$Age == 11)
length(thebad)
thebad <- c(1,5,9)
ver1 <- append(select, "NR", after = thebad-1)
thebad-1
thebad <- c(3,5,9)
ver1 <- append(select, "NR", after = thebad-1)
thebad <- c(3,5)
ver1 <- append(select, "NR", after = thebad-1)
ver1 <- append(select, "NR", after = thebad)
ver1 <- append(select, "NR", after = c(1,3))
thebad <- which(df$Age == 8)
ver1 <- append(select, "NR", after = thebad)
result <- data.frame(df_dummy, Score = ver1)
View(result)
Risk_Score.vector <- function(diabetes, gender, smoke, age, sbp, cholesterol){
#
# diabetes = Diabetes
# gender = Gender
# smoke = Smoking
# age = Age
# sbp = Systolic_Blood_Pressure
# cholesterol = cholesterol
age_levels <- function(x){
if(x < 40){x <- 8}
if(x > 75){x <- 8}
if(x >= 70 & x <= 74){x <- 7}
if(x >= 65 & x <= 69){x <- 6}
if(x >= 60 & x <= 64){x <- 5}
if(x >= 55 & x <= 59){x <- 4}
if(x >= 50 & x <= 54){x <- 3}
if(x >= 45 & x <= 49){x <- 2}
if(x >= 40 & x <= 44){x <- 1}
return(x)
}
sbp_levels <- function(x){
if(x < 120){x <- 1}
if(x >= 180){x <- 5}
if(x >= 160 & x <= 179){x <- 4}
if(x >= 140 & x <= 159){x <- 3}
if(x >= 120 & x <= 139){x <- 2}
return(x)
}
cho_levels <- function(cho) {
if(cho < 4){cho <- 1}
if(cho >= 4 & cho <= 4.9){cho <- 2}
if(cho >= 5 & cho <= 5.9){cho <- 3}
if(cho >= 6 & cho <= 6.9){cho <- 4}
if(cho >= 7){cho <- 5}
return(cho)
}
age_1 <- sapply(age, age_levels)
sbp_1 <- sapply(sbp, sbp_levels)
cholesterol_1 <- sapply(cholesterol, cho_levels)
df_dummy <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age,
SBP = sbp, Total_Cholesterol = cholesterol)
df <- data.frame(Diabetes = diabetes, Gender = gender, Smoke = smoke,
Age = age_1,
SBP = sbp_1, Total_Cholesterol = cholesterol_1)
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
message(paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score"))
df <- df[df$Age!= 8, ]
}
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
if(length(thebad) > 0){
ver1 <- append(select, "NR", after = thebad)
result <- data.frame(df_dummy, Score = ver1)
} else {
result <- data.frame(df_dummy, Score = select)
}
return(result)
}
Age <- c(40, 87, 65, 53, 71) #Age in years
Gender <- c(0,0,0,1,1) #0=female, 1=male
Smoking <- c(1,1,0,1,0) #0=non-smoker 1=smoker
Systolic_Blood_Pressure <- c(129, 157, 134, 189, 141) #SBP in mmHg
Diabetes <- c(1,1,1,0,1) #0=not diabetic 1=diabetic
cholesterol <- c(0, 5.1, 4.5, 0, 8.3) #Total cholesterol (mmol/L, 0=unknown cholesterol)
prueba <- Risk_Score.vector(diabetes = Diabetes, gender = Gender,
smoke = Smoking, age = Age, sbp = Systolic_Blood_Pressure,
cholesterol = cholesterol)
Age <- c(40, 55, 65, 53, 71, 37) #Age in years
Gender <- c(0,0,0,1,1, 1) #0=female, 1=male
Smoking <- c(1,1,0,1,0, 1) #0=non-smoker 1=smoker
Systolic_Blood_Pressure <- c(129, 157, 134, 189, 141, 179) #SBP in mmHg
Diabetes <- c(1,1,1,0,1, 1) #0=not diabetic 1=diabetic
cholesterol <- c(0, 5.1, 4.5, 0, 8.3, 6) #Total cholesterol (mmol/L, 0=unknown cholesterol)
prueba <- Risk_Score.vector(diabetes = Diabetes, gender = Gender,
smoke = Smoking, age = Age, sbp = Systolic_Blood_Pressure,
cholesterol = cholesterol)
View(prueba)
devtools::load_all(".")
devtools::load_all(".")
prueba1 <- Risk_Score.vector(diabetes = 1, gender = 0, smoke = 1, age = 60,
sbp = 169, cholesterol = 8
)
prueba1
prueba <- Risk_Score.vector(diabetes = Diabetes, gender = Gender,
smoke = Smoking, age = Age, sbp = Systolic_Blood_Pressure,
cholesterol = cholesterol)
prueba1 <- Risk_Score.vector(diabetes = 1, gender = 0, smoke = 1, age = 60,
sbp = 169, cholesterol = 8
)
prueba <- Risk_Score.vector(diabetes = Diabetes, gender = Gender,
smoke = Smoking, age = Age, sbp = Systolic_Blood_Pressure,
cholesterol = cholesterol)
prueba
prueba1 <- Risk_Score.vector(diabetes = 1, gender = 0, smoke = 1, age = 60,
sbp = 169, cholesterol = 8
)
prueba1
Age <- c(40, 55, 65, 53, 71, 37) #Age in years
Gender <- c(0,0,0,1,1, 1) #0=female, 1=male
Smoking <- c(1,1,0,1,0, 1) #0=non-smoker 1=smoker
Systolic_Blood_Pressure <- c(129, 157, 134, 189, 141, 179) #SBP in mmHg
Diabetes <- c(1,1,1,0,1, 1) #0=not diabetic 1=diabetic
cholesterol <- c(0, 5.1, 4.5, 0, 8.3, 6) #Total cholesterol (mmol/L, 0=unknown cholesterol)
df <- data.frame(Diabetes, Gender, Smoking, Age, Systolic_Blood_Pressure,
cholesterol)
age_levels <- function(x){
if(x < 40){x <- 8}
if(x > 75){x <- 8}
if(x >= 70 & x <= 74){x <- 7}
if(x >= 65 & x <= 69){x <- 6}
if(x >= 60 & x <= 64){x <- 5}
if(x >= 55 & x <= 59){x <- 4}
if(x >= 50 & x <= 54){x <- 3}
if(x >= 45 & x <= 49){x <- 2}
if(x >= 40 & x <= 44){x <- 1}
return(x)
}
sbp_levels <- function(x){
if(x < 120){x <- 1}
if(x >= 180){x <- 5}
if(x >= 160 & x <= 179){x <- 4}
if(x >= 140 & x <= 159){x <- 3}
if(x >= 120 & x <= 139){x <- 2}
return(x)
}
cho_levels <- function(x) {
if(x < 4){x <- 1}
if(x >= 4 & x <= 4.9){x <- 2}
if(x >= 5 & x <= 5.9){x <- 3}
if(x >= 6 & x <= 6.9){x <- 4}
if(x >= 7){x <- 5}
return(x)
}
df$Age <- sapply(df$Age, age_levels)
View(df)
colnames(df) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Cholesterol")
df$SBP <- sapply(df$Systolic_Blood_Pressure)
df$Cholesterol <- sapply(df$Cholesterol, cho_levels)
df$SBP <- sapply(df$SBP, sbp_levels)
View(df)
df <- data.frame(Diabetes, Gender, Smoking, Age, Systolic_Blood_Pressure,
cholesterol)
colnames(df) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Cholesterol")
df_old <- df
df$Age <- sapply(df$Age, age_levels)
df$SBP <- sapply(df$SBP, sbp_levels)
df$Cholesterol <- sapply(df$Cholesterol, cho_levels)
which(df$Age == 8)
View(df)
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
devtools::load_all(".")
prueba <- Risk_Score.vector(diabetes = Diabetes, gender = Gender,
smoke = Smoking, age = Age, sbp = Systolic_Blood_Pressure,
cholesterol = cholesterol)
dat <- CardiovascularRisk::ref1
devtools::load_all(".")
devtools::load_all(".")
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
message(paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score"))
df <- df[df$Age!= 8, ]
}
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
df$Gender[i]
dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i]
dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i]
df$Diabetes[i]
dat$Diabetes == df$Diabetes[i]
dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i]
dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i]
dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i]
View(df)
dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
View(df)
View(df_old)
View(df)
View(df_old)
View(df)
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
dat$Cholesterol == df$Total_Cholesterol[i]
colnames(df) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
colnames(df_old) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
df$Cholesterol <- sapply(df$Total_Cholesterol, cho_levels)
View(df)
df <- data.frame(Diabetes, Gender, Smoking, Age, Systolic_Blood_Pressure,
cholesterol)
colnames(df) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
df_old <- df
colnames(df_old) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
age_levels <- function(x){
if(x < 40){x <- 8}
if(x > 75){x <- 8}
if(x >= 70 & x <= 74){x <- 7}
if(x >= 65 & x <= 69){x <- 6}
if(x >= 60 & x <= 64){x <- 5}
if(x >= 55 & x <= 59){x <- 4}
if(x >= 50 & x <= 54){x <- 3}
if(x >= 45 & x <= 49){x <- 2}
if(x >= 40 & x <= 44){x <- 1}
return(x)
}
df$Age <- sapply(df$Age, age_levels)
df$SBP <- sapply(df$SBP, sbp_levels)
df$Cholesterol <- sapply(df$Total_Cholesterol, cho_levels)
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
message(paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score"))
df <- df[df$Age!= 8, ]
}
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
View(df)
df <- data.frame(Diabetes, Gender, Smoking, Age, Systolic_Blood_Pressure,
cholesterol)
colnames(df) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
df_old <- df
colnames(df_old) <- c("Diabetes", "Gender", "Smoke", "Age", "SBP", "Total_Cholesterol")
df$Age <- sapply(df$Age, age_levels)
df$SBP <- sapply(df$SBP, sbp_levels)
df$Total_Cholesterol <- sapply(df$Total_Cholesterol, cho_levels)
if(length(which(df$Age == 8)) > 0){
thebad <- which(df$Age == 8)
message(paste("The patient number:", which(df$Age == 8), "has the age out of range to calculate the risk score"))
df <- df[df$Age!= 8, ]
}
select <- vector()
for (i in 1:nrow(df)) {
dat <- CardiovascularRisk::ref1
select[i] <- dat[dat$Diabetes == df$Diabetes[i] & dat$Gender == df$Gender[i] &
dat$Smoke == df$Smoke[i] & dat$Age == df$Age[i] &
dat$SBP == df$SBP[i] & dat$Cholesterol == df$Total_Cholesterol[i],
"Score"]
}
if(length(thebad) > 0){
ver1 <- append(select, "NR", after = thebad)
result <- data.frame(df_old, Score = ver1)
} else {
result <- data.frame(df_old, Score = select)
}
result
devtools::load_all(".")
?Risk_Score
?Risk_Score
?Risk_Score
